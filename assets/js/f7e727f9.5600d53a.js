"use strict";(self.webpackChunktechguide_wiki=self.webpackChunktechguide_wiki||[]).push([[447],{3905:(e,t,a)=>{a.d(t,{Zo:()=>o,kt:()=>f});var i=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},l=Object.keys(e);for(i=0;i<l.length;i++)a=l[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)a=l[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var c=i.createContext({}),d=function(e){var t=i.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},o=function(e){var t=d(e.components);return i.createElement(c.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},g=i.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,c=e.parentName,o=r(e,["components","mdxType","originalType","parentName"]),u=d(a),g=n,f=u["".concat(c,".").concat(g)]||u[g]||p[g]||l;return a?i.createElement(f,s(s({ref:t},o),{},{components:a})):i.createElement(f,s({ref:t},o))}));function f(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,s=new Array(l);s[0]=g;var r={};for(var c in t)hasOwnProperty.call(t,c)&&(r[c]=t[c]);r.originalType=e,r[u]="string"==typeof e?e:n,s[1]=r;for(var d=2;d<l;d++)s[d]=a[d];return i.createElement.apply(null,s)}return i.createElement.apply(null,a)}g.displayName="MDXCreateElement"},3724:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>d});var i=a(7462),n=(a(7294),a(3905));const l={title:"High Availability Mode Replication",sidebar_position:2,slug:"/eb3c1c9d-ba50-4ccf-bf63-117a32ca0d16"},s=void 0,r={unversionedId:"Network---System/Virtualization/Proxmox/High-Availability-Mode-Replication",id:"Network---System/Virtualization/Proxmox/High-Availability-Mode-Replication",title:"High Availability Mode Replication",description:"test",source:"@site/docs/Network---System/Virtualization/Proxmox/High-Availability-Mode-Replication.md",sourceDirName:"Network---System/Virtualization/Proxmox",slug:"/eb3c1c9d-ba50-4ccf-bf63-117a32ca0d16",permalink:"/docs/eb3c1c9d-ba50-4ccf-bf63-117a32ca0d16",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Network---System/Virtualization/Proxmox/High-Availability-Mode-Replication.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"High Availability Mode Replication",sidebar_position:2,slug:"/eb3c1c9d-ba50-4ccf-bf63-117a32ca0d16"},sidebar:"tutorialSidebar",previous:{title:"Proxmox Cluster Installation",permalink:"/docs/e845c1ff-7e1e-4db0-befc-8e1f278df3a2"},next:{title:"Comming soon",permalink:"/docs/b7aca39c-a24e-43ab-b045-33b5d9900499"}},c={},d=[{value:"Setup Datastore for Virtual Machine",id:"08acd513e8ce42b5acf5a98178f32d9f",level:2},{value:"2. HA Mode Configuration",id:"a3a681fa2eb04a3aa695f61a78b664e8",level:2},{value:"<u>2.1 Setup New Virtual Machine</u>",id:"c1575aee17fb47098cb466014b2b863c",level:3},{value:"<u>2.2 Configuration for VM Replication</u>",id:"623cd8e41519400dbf9100f87d0ff56a",level:3},{value:"<u>2.3 Set HA mode for VM</u>",id:"305d82b12c934d62859b8bfa2e591351",level:3},{value:"<u>2.4 Test HA Mode</u>",id:"8bf77051fa9f4c13947a048e9b62578d",level:3}],o={toc:d},u="wrapper";function p(e){let{components:t,...l}=e;return(0,n.kt)(u,(0,i.Z)({},o,l,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"test"),(0,n.kt)("h2",{id:"08acd513e8ce42b5acf5a98178f32d9f"},"Setup Datastore for Virtual Machine"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"We use ZFS-RAIDZ (software-defined storage)"),(0,n.kt)("li",{parentName:"ul"},"There are 2 data disks on every PVE server")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(7153).Z,width:"4242",height:"1098"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Create ZFS on PVE-01 and tick")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(7598).Z,width:"4240",height:"1536"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Create ZFS on PVE-02, PVE-03 but do not tick \u201cAdd Storage\u201d")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(6675).Z,width:"4242",height:"1526"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(4555).Z,width:"4230",height:"1526"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Add DATASTORE to all PVE servers")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(6884).Z,width:"4238",height:"1410"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Now We have the same storage named DATASTORE on all PVE servers")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(3029).Z,width:"4230",height:"1070"})),(0,n.kt)("h2",{id:"a3a681fa2eb04a3aa695f61a78b664e8"},"2. HA Mode Configuration"),(0,n.kt)("h3",{id:"c1575aee17fb47098cb466014b2b863c"},(0,n.kt)("u",null,"2.1 Setup New Virtual Machine")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(7578).Z,width:"3718",height:"2058"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Choose the ISO file that has been uploaded before")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(3327).Z,width:"1440",height:"1018"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Keep default setting")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(6908).Z,width:"1430",height:"1020"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Create VM Disk (if running window we can switch to SATA)")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(240).Z,width:"1434",height:"1026"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Set the number of core CPU and RAM capacity")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(803).Z,width:"1442",height:"1020"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(2839).Z,width:"1446",height:"998"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Set Network Interface Card type, Mac Address and NIC connect to \u201cBridge\u201d (Switch)")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(8248).Z,width:"1446",height:"1020"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Confirm to create a VM")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(9828).Z,width:"1436",height:"1012"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"VM was created and we can modify VM hardware, set boot order, and auto start,\u2026")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(6660).Z,width:"3710",height:"1280"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(3438).Z,width:"3718",height:"1332"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Start the VM and set up the OS as running on bare-metal")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(8145).Z,width:"3724",height:"1618"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(3942).Z,width:"3754",height:"1944"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(4807).Z,width:"3740",height:"2074"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(5097).Z,width:"4270",height:"2078"})),(0,n.kt)("h3",{id:"623cd8e41519400dbf9100f87d0ff56a"},(0,n.kt)("u",null,"2.2 Configuration for VM Replication")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"VM are running on PVE-01 and should be replicate to PVE-02, PVE-03")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(4574).Z,width:"3740",height:"1570"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Set time for replicating, do the same to PVE-03")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(2697).Z,width:"3730",height:"1792"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(783).Z,width:"3738",height:"948"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"We can now start syncing data")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(4920).Z,width:"3734",height:"1580"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Now all PVE have VM Disk")),(0,n.kt)("h3",{id:"305d82b12c934d62859b8bfa2e591351"},(0,n.kt)("u",null,"2.3 Set HA mode for VM")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Create an HA group that Vm can migrate to these server in the group")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(4615).Z,width:"3726",height:"1690"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Enable HA mode for VM")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(9585).Z,width:"3728",height:"1730"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(3373).Z,width:"3746",height:"1238"})),(0,n.kt)("h3",{id:"8bf77051fa9f4c13947a048e9b62578d"},(0,n.kt)("u",null,"2.4 Test HA Mode")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"VM running on PVE-02")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(6955).Z,width:"3742",height:"2178"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Power off PVE-02")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(2806).Z,width:"3722",height:"1604"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Can not ping to VM")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(7240).Z,width:"3714",height:"2242"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Cluster take 3-5 minutes to make sure PVE-02 is down"),(0,n.kt)("li",{parentName:"ul"},"VM will migrate to PVE-01 automatically and start successfuly")),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(5287).Z,width:"3754",height:"2242"})))}p.isMDXComponent=!0},3942:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1128366564-9a82746bc5bf8c8b2eb0f9e921b5f89c.png"},9828:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1129969869-5e62f3e3a3b90ef22435095ef7aadbd9.png"},6884:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1181652769-f417d7938900638e01ce8a31cc5b6b53.png"},4615:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1350269263-f64816055fa9d9ce5f084bdb49cc7351.png"},8145:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1389879648-419ccb70c3383a8412a82f1ec764b3d0.png"},7153:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1436961637-207b47767cce7963dd9f9d12de89e9cb.png"},4555:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1446025234-6c00af4a210accb56a1f6a8dd860db9d.png"},240:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1742973488-705d1ba1e4e9327e5a367758042639e6.png"},6955:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1767662884-e47e3c52201dcf0e99d917e562b30b8d.png"},2806:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/188329903-aeecc8e51914d9e31df79ba5bcb483db.png"},5287:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/1907468078-51e7d968dc978c9835acd8f712aaa107.png"},7240:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/195274063-0cfabfa5e4573b11b1b758c0c7f557d4.png"},4920:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/2035497060-c995da01f621d61af6aac36d45098e7b.png"},9585:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/222086902-0f4dc0aa73c02780add2d8780e9fa0b3.png"},2697:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/229315828-1137608d6f194c1b20f5433be7d8f3ab.png"},6908:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/307063625-457c554f12ff7765773cded127907468.png"},4807:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/308982124-15a41efdd5c5aa34864c12ac10c8f9d5.png"},3327:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/331397217-6fdc58f6b0aeaa2fbc1804cf24c80d5e.png"},3438:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/372047439-ea7558765ff4ac40a43475b82c29091a.png"},3373:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/442555760-f09ef0485db9051041684b2f6756df1f.png"},8248:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/456546760-428dea1d6d44d41717158c66f3752948.png"},5097:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/472884498-3edcbaa172b5f52e44cd66c9b91347eb.png"},6675:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/566193205-1a11962f22aa360baca133f28114e8ce.png"},803:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/628688487-e4e5c38baa3330115b5bfcee933408c5.png"},783:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/637847736-b18e89cbb6ecf034d20bf1aa71d6b687.png"},4574:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/719186118-aad2466ade72a3843baf942502fd2e8a.png"},3029:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/745500008-4a88a251b45ccacc5041fb9b979ee665.png"},6660:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/78791423-8e719b400b3db686754dd713cfc26433.png"},7598:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/864038790-f0897fc85144c921a26e679428783afc.png"},7578:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/928943810-05a07a0aba995dec1aa2673f3dcbe4c4.png"},2839:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/999006366-b395e12ed94532f47b20faa9c92f269b.png"}}]);